
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Generation process &#8212; pyleecan  documentation</title>
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/favicon.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 
    <style type="text/css">
      table.right { float: left; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
      .related { display: none; }
      
    </style>
    <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head><body>
<div class="pageheader">
  <ul>
    <li><a class="item" href="index.html">Home</a></li>
    <li><a class="item" href="tutorials.html">Tutorials</a></li>
    <li><a class="item" href="pyleecan.html">Documentation</a></li>
    <li><a class="item" href="development.html">Development</a></li>
    <li><a class="item"href="contact.html">Contact</a></li>
  </ul>
  <div>
    <a href="index.html">
      <img src="_static/favicon.png" alt="PYLEECAN"/>
    </a>
  </div>
</div>
<script type="text/javascript">

    $(document).ready(function() {
         $('.sphinxsidebarwrapper li').each(function(){
          // select href
          var href = $(this).find('a').attr('href');
          // Check filename
          if(href == "#"){

           // Add active class
           $(this).addClass('active');
          }
         });
    });
</script>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="pyleecan.html">pyleecan  documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">

<div class="well sidebar-nav">
    <h3><a href="development.html" title="Development">How to Contribute</a></h3>
  <ul class="nav nav-list">
      <li >
        <a href="project.organization.html" title="Project organization">Project organization</a></li>
    <li >
      <a href="code.contribution.html" title="Code contribution">Code contribution</a></li>
      <li >
        <a href="doc.contribution.html" title="Doc contribution">Doc contribution</a></li>
      <li >
        <a href="test.contribution.html" title="Test contribution">Test contribution</a></li>
  </ul>
</div>



<div class="well sidebar-nav">
    <h3><a href="code.contribution.html" title="Code contribution">Code contribution</a></h3>
  <ul class="nav nav-list">
      <li >
        <a href="object.organization.html" title="Object Organization">Object organization</a></li>
      <li >
        <a href="coding.convention.html" title="Coding Convention">Coding convention</a></li>
  </ul>
</div>


<div class="well localtoc">
  <h3><a href="pyleecan.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Generation process</a><ul>
<li><a class="reference internal" href="#the-gen-dict-structure">The gen_dict structure</a></li>
<li><a class="reference internal" href="#file-organization">File organization</a></li>
</ul>
</li>
</ul>

</div>

  <div class="well source" role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/generation.process.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div class="well badges">
<ul>
<a href="https://github.com/Eomys/pyleecan">
<img src="https://img.shields.io/github/release/Eomys/pyleecan.svg?style=social&label=Release" alt="Release"><br>
<img src="https://img.shields.io/github/forks/Eomys/pyleecan.svg?style=social&label=Forks" alt="Forks"><br>
<img src="https://img.shields.io/github/stars/Eomys/pyleecan.svg?style=social&label=Stars" alt="Stars"><br>
<img src="https://img.shields.io/github/watchers/Eomys/pyleecan.svg?style=social&label=Watch" alt="Watchers"><br>
</a>
</ul>
</div>

        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="generation-process">
<h1>Generation process<a class="headerlink" href="#generation-process" title="Permalink to this headline">¶</a></h1>
<p>All the generation code is gathered in <strong>/Generator</strong>. To simplify all the process, we have split the generation of the
code in several independent steps. The first one is to read all the CSV files to create a complex structure
(dictionary gen_dict) with all the reference data. Then this structure is used to generate the class. As the step are
separated, they can evolve separately. For instance, you can change the way the data are stored in the CSV file without
changing the generation as long as you keep the data structure organization.</p>
<div class="section" id="the-gen-dict-structure">
<h2>The gen_dict structure<a class="headerlink" href="#the-gen-dict-structure" title="Permalink to this headline">¶</a></h2>
<p><strong>The structure gen_dict</strong> is a dictionary gathering all the reference data for all the classes. It is the structure that is
generated by the first step and which is used to generate the code.</p>
<p><strong>The structure gen_dict</strong> is compose of several imbricated list and dict. The fist level is a dictionary with the group
‘Slot’, ‘Machine’… as key and dictionary as value. This first level match the group separation of CSV files.</p>
<p>At the second level, we have the content of an CSV file as a dictionary with CSV name (class name) as key and dictionary
as value.</p>
<p>The third level correspond to the data of a class (or the sheet of the CSV file). These new dictionary contains the follows keys:</p>
<ul class="simple">
<li><span class="green">properties</span> : a list of dictionary with key matching the CSV sheet column: name, type, min, max, value, desc (one dictionary for each property of the class)</li>
<li><span class="green">constants</span>: a list of dictionary with the key name, value (one for each constant of the class)</li>
<li><span class="green">methods</span>: a list of all the class method name</li>
<li><span class="green">daughters</span>: a list of all the class daughter name</li>
<li><span class="green">package</span>: name of the group of the class (same as the first dictionary key, but useful for generation)</li>
<li><span class="green">desc</span>: a string with the description of the class (for help text)</li>
<li><span class="green">mother</span>: a string with the mother class name (if empty, FrozenClass will be used as default)</li>
</ul>
<p>For instance, the description of the parameter H0 of Slot_Type_1_0 is stored in:
gen_dict[‘Slot’][‘Slot_Type_1_0’][‘properties’][0][‘desc’] (if we suppose that H0 is first in the list of properties).</p>
</div>
<div class="section" id="file-organization">
<h2>File organization<a class="headerlink" href="#file-organization" title="Permalink to this headline">¶</a></h2>
<p>The gen_dict structure is then used for the class generation. The respective code can be found in
<strong>/Generator/class_generator.py</strong> file. Note that some common function had been gathered in read_fct.</p>
<p>To gain in readability, the generated files have been split in several part and some function have been dedicated to
generate specific part of the code. The generation process is very complex since there are many possible cases.
For instance, we need to adapt the code according to the type of property (a PYLEECAN type would need the corresponding
import at the start of the file, some class are inherited, some are not, some use numpy array, some don’t…). If you need
to change this code, please consider that it should work for every single class in PYLEECAN: always start by modifying the
class generation and then check that all the test are still right.</p>
<p>The result are saved in <strong>/Classes/class_name.py</strong>. As these files are completely rewritten by the generator, you must
never modify them yourself. If you need to change the code of the generator, you should start by looking these files
(for different cases with/without PYLEECAN classes, with/without inheritance…) to know what you need to generate.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="pyleecan.html">pyleecan  documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019 pyleecan developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
  </body>
</html>